# 테스트 조직

## AAA로 테스트 일관성 유지
- 준비 실행 단언 부분(AAA)으로 조직
- 사후(After) 테스트를 실행할 때 어떤 자원을 할당했다면 잘 정리 되었는지 확인해야 합니다.

## 동작 테스트 vs 메서드 테스트
- 테스트를 작성할 때는 클래스 동작에 집중 해야하며 개별 메서드를 테스트한다고 생각하면 안 됩다.
- 개별 메서드를 테스트하는 것이 아니라 클래스의 종합적인 동작을 테스트 해야한다.

## 테스트와 프로덕션 코드의 관계

### 테스트와 프로덕션 코드 분리
- 테스트를 프로덕션 코드와 같은 프로젝트에 넣을지 결정이 필요.
- 3가지 방법
    1. 테스트를 프로덕션 코드와 같은 디렉터리 및 패키지에 넣기
    2. 테스트를 별도 디렉터리로 분리하지만 프로덕션 코드와 같은 패키지에 넣기
    3. 테스트를 별도의 디렉터리와 유사한 패키지에 유지하기


### 내부 데이터 노출 vs 내부 동작 노출
- 테스트를 위해 내부 데이터를 노출하는 것은 테스트와 프로덕션 코드 사이에 과도한 결합을 초래
- private 메서드 테스트는 비권장
- <u>내부 행위를 테스트 하고자 한다는건, 설계에 문제가 있다는 뜻이다.</u>

## 집중적인 단일 목적 테스트의 가치
- 다수의 케이스를 별도의 테스트 메서드로 분리하고, 각각 검증하는 동작을 표현하는 이름을 붙이기
- 단언 실패시 실패한 테스트 이름으로 문제 파악이 빨라짐
- junit은 각 테스트를 별도의 인스턴스로 실행하기 때문에 실패한 테스트와 다른 테스트의 영향도를 없앨수 있다.
- 모든 케이스의 실행 보장. 단언이 실패하면 현재 테스트 메서드만 중단

## 문서로서의 테스트

### 일관성 있는 이름으로 테스트 문서화
- 테스트 하려는 맥닥보다는 어떤맥락에서 어떤 행동을 호출했을때 어떤 결과자 나오는지 명시
    - 어떤 동작을 하면 어떤 결과가 나온다.
    - 어떤 결과는 어떤 조건에서 발생한다.
    - 주어진 조건에서 어떤 일을 하면 어떤 결과가 나온다.

### 테스트를 의미 있게 만들기
테스트가 어떤일을 하는지 파악하기 어렵다면 테스트를 개선하는것이 좋다.
- 지역변수 이름 개선
- 의미있는 상수 도입
- 햄크레스트 단언 사용
- 커다란 테스트를 작게 나누기
- 도우미 메서드와 @Before메서드 활용


## @Before @After 더 알기
### @Before
-  @Before는  클래스에 있는 모든 테스트 메서드 실행에 앞서 실행된다.
- 초기화 작업이 여러개인경우 @Before 메서드도 여러개로 분할하라
```java
@Before createAccount
@Before resetAccountLogs
```
- 다수의 @Before메서드가 있을때 Junit은 실행 순서를 보장하지 않는다

#### @After
- 클래스에 있는 각 테스트를 한 후에 실행
- 테스트가 실패해도 실행된다.

### @BeforeClass 와 @AfterClass
- 클래스에 있는 어떤 테스트를 처음 실행하기전 한번만 실행
> 실행 순서  
@BeforeClass -> @Before -> @Test -> After -> @Before -> @Test -> @After ... -> @AfterClass

## 녹색이 좋다: 테스트를 의미 있게 유지
- 실패하는 테스트가 있다면 그 테스트를 고친 후 새로운 테스트를 추가하자
- 모든 테스트가 항상 통과된 상태로 유지하자

### 테스트를 빠르게
- 대부분의 단위 테스트는 빨라야 한다
    - 전체 데트스 실행 대신, 필요하다고 생각되는 테스트나 패키지 단위의 텐스트 실행
    - 외부 자원에 접근하는 테스트가 많다면 느려진다.
    
### 테스트 제외
- 다수의 실패 테스트를 만난다면, 문제가 되는 테스트에 집중하고 그외 실패 테스트를 주석처리하는게 좋다.
- 테스트에 @Ignore 애너테이션을 달면 해당 메서드가 주석처리 된다.
    ```java
    @Test
    @Ignore("don't forget me!")
    public void somethingWeCannotHandleRightNow(){
      //...
    } 
    ```
