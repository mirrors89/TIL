# 더 큰 설계 문제

## Profile 클래스와 SRP
- 클래스를 변경할 때는 단 한 가지 이유만 있어야함 (SRP - 단일 책임 원칙)
- 클래스에 더 많은 책임이 존해할수록 클래스에 있는 코드를 변경할 때 기존의 다른 동작들을 깨기 쉽다.
- 더작고 집중화된 클래스는 다른 맥락에서도 가치를 제공할 수 있다.

## 새로운 클래스 추출
- 책임 두 개를 분리하여 각 클래스로 할당하고 각 클래스가 작고 SRP에도 맞도록 한다.

## 명령-질의 분리
- 어떤 값을 반환하고 부작용을 발생시키는 메서드는 명령-질의 분리 원칙을 위반
- 메서드는 명령을 실행 하거나 질의에 대답 할 수 있지만, 두 작업을 모두 하면 안 된다.
- 질의 메서드가 객체 상태를 변경하면 두 번 호출하는 것이 불가능할 수도 있다.

## 단위 테스트의 유지 보수 비용
- 
- 보통 돌아오는 가치가 훨씬 크기 때문에 깨진 테스트 코드를 고치는 비용을 받아들인다.
- 실패하는 테스트의 정도를 부정적인 설계 지표로 인식하는 것도 생각하자
- 많은 테스트가 동시에 깨질수록 더욱더 많은 설계가 문제가 있을 것이다.

### 자신을 보호하는 방법
- 여러 테스트에 걸친 코드 중복은 두가지 문제가 있다.
    - 테스트를 따르기가 어려워진다.
    - 작은 코드 조각들을 단일 메서드로 추출하면 그 조각들을 변경해야할 때 미치는 영향을 최소화 할 수 있다.
- SRP를 위반하면
    - 클래스는 점점 커지고
    - 다른 클래스에 대한 의존성이 커지고
    - 테스트를 설정하는데 더 많은 노력이 요구된다.

### 깨진 테스트 고치기
- private 메서드를 새로운 클래스의 public 메서드로 이동하면 그 클래스들이 일반적으로 테스트 커버리지가 충분하지 않음을 발견할 것이다.
- public이 되면 테스트를 작성하여 새롭게 노출된 동작을 문서화해 두자.


## 다른 설계에 관한 생각들
- 여러 클래스에 구현 상태가 흩어져 있을 때의 코드냄새(code smell)를 기능의 산재(shotgun surgery)라고 한다.
- 반복이 필요한 메서드에는 방문자 패턴(Visitor pattern)을 고려해 보자.
- 시스템 걸계에 대해 비판적인 눈을 유지하고 최상의 설계는 없다는 것을 명심하자.
